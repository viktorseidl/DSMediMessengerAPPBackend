<?php
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      HASH CLASS - KEY GENERATOR
    //      @autor Fernando Seidl
    //      
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
class HASH{
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      ---> STATIC METHOD
    //      MAKE RANDOM SHA256 STRING INCLUDING A SALT STRING
    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public static function make($string, $salt=null){
        return hash('sha256', $string . $salt);
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      ---> STATIC METHOD
    //      GENERATE A SALT STRING
    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public static function salt($length){
        return bin2hex(random_bytes($length));
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      ---> STATIC METHOD
    //      CREATE A UNIQUE HASH
    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public static function unique($hash=null){
        return self::make(uniqid($hash));
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      ---> STATIC METHOD
    //      MAKE RANDOM STRING BY LENGHT
    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public static function randomstring($len){
        $string = "";
        $chars = "ABCDEFGHIJKLMNOPQRST#!?+UVWXYZabcdefghijklmnopq\$%rstuvwxyz0123456789#_!?+";
        for($i=0;$i<$len;$i++)
        $string.=substr($chars,rand(0,strlen($chars)),1);
        return $string;
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    //      ---> STATIC METHOD
    //      MAKE RANDOM STRING BY LENGHT
    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public static function randompersnrstring($len){
        $string = "";
        $chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        for($i=0;$i<$len;$i++)
        $string.=substr($chars,rand(0,strlen($chars)),1);
        return $string;
    }
    public static function randomotpstring($len){
        $string = "";
        $chars = "0123456789";
        for($i=0;$i<$len;$i++)
        $string.=substr($chars,rand(0,strlen($chars)),1);
        return $string;
    }
}

?>